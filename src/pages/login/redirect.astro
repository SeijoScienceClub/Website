---
const code = Astro.url.searchParams.get("code");
fetch("https://discordapp.com/api/oauth2/token", {
  method: "POST",
  body: new URLSearchParams({
    client_id: "1319225068592824411",
    client_secret: process.env.DISCORD_CLIENT_SECRET || "",
    grant_type: "authorization_code",
    code: `${code}`,
    redirect_uri: "https://seijoscience.com/login/redirect",
  }),
}).then((Response) => {
  const jsonPromise = Response.json();
  jsonPromise.then((data) => {
    console.log(data);
    fetch("https://discordapp.com/api/users/@me", {
      headers: {
        Authorization: `Bearer ${data[0].access_token}`,
      },
    });
  });
});
---

<p>Redirecting...</p>
